<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>SceneStreamer: Scenario Generation as Next Token Group Prediction | MetaDriverse</title>
    <meta name="author" content="  MetaDriverse">
    <meta name="description" content="MetaDriverse for AI and Autonomy Research!
">
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website">

    <!-- Chenda additional setting -->
    <link rel="stylesheet" id="elementor-frontend-css" href="https://template.makedreamwebsite.com/wp-content/plugins/elementor/assets/css/frontend-lite.min.css?ver=3.9.0" media="all">
    <link rel="stylesheet" id="elementor-post-1391-css" href="https://template.makedreamwebsite.com/wp-content/uploads/elementor/css/post-1391.css?ver=1670496920" media="all">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fullPage.js/3.1.2/fullpage.min.css">
    <script src="https://unpkg.com/infinite-scroll@3/dist/infinite-scroll.pkgd.min.js"></script>
    <!-- Magnific Popup CSS and JS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
    <script src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Bootstrap Table -->
    <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%9A%98%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://metadriverse.github.io//scenestreamer/">

    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://vail-ucla.github.io/" rel="external nofollow noopener" target="_blank"><img class="navbar-logo" src="/assets/img/UCLAxMetaDriverse-Logo-3.png" alt="Lab logo"></a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">Projects</a>
              </li>
              

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/team/">VAIL</a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container-fluid mt-5">
      
      <div class="row justify-content-md-center">
        <div class="col-sm-8">
          <!-- research.html -->
<div class="post">
    <header class="post-header center-text">
        <h1 class="post-title">SceneStreamer: Scenario Generation as Next Token Group Prediction</h1>
        <p class="post-description"></p>
        
        <div class="col-12 md-5" style="margin-bottom: 2rem;">
            <h6 style="text-align: center; font-size: 1.2rem; margin-bottom: 0.5rem;">
                
                <a href="https://pengzhenghao.github.io/" rel="external nofollow noopener" target="_blank"><b>Zhenghao Peng</b></a>
                <sup></sup>
                , 
                
                <a href="#"><b>Yuxin Liu</b></a>
                <sup></sup>
                , 
                
                <a href="https://boleizhou.github.io/" rel="external nofollow noopener" target="_blank"><b>Bolei Zhou</b></a>
                <sup></sup>
                
                
            </h6>
            <h6 style="text-align: center; font-size: 1rem;">
                
                <sup></sup>
                </h6>
<p>University of California, Los Angeles</p>
                
                
            
        </div>
        
        <div class="col-12 md-5" align="center">
            <h6 style="text-align: center; font-size: 1.2rem;">
                
                <a href="https://github.com/metadriverse/scenariostreamer" rel="external nofollow noopener" target="_blank"><b>Code</b></a>
                
                
                
                
                
                
                | <a href="https://arxiv.org/pdf/2506.23316" rel="external nofollow noopener" target="_blank"><b>Paper</b></a>
                
            </h6>
        </div>
    </header>


    <article>
        
        
        <div class="research-section">
            <style>
.video-container {
  position: relative;
  max-width: 100%;
  margin: 0 auto 0;
}

.video-container video {
  display: block;
  margin: 0 auto;
  max-width: 100%;
  max-height: 100%;
}

.video-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-gap: 20px;
}
.video iframe {
    width: 100%;
    height: 250px;
}

@media (max-width: 600px) {
    .video-grid {
        grid-template-columns: 1fr;
    }
}
</style>

<div class="img-container" style="width: 80%; margin: auto auto;">
    <img src="../assets/img/scenestreamer/teaser.png" class="my-image" alt="Image">
</div>

<p><strong>SceneStreamer</strong> is a unified autoregressive transformer that treats the entire driving scene—map, traffic lights, agent states, and motions—as one long token stream and rolls it out step-by-step, enabling realistic, interactive, and infinitely extensible traffic simulation.</p>

<p> 
 
<img class="emoji" title=":traffic_light:" alt=":traffic_light:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f6a5.png" height="20" width="20">
Generates traffic light signals, agent initial states, and traffic participant trajectories in a single model—no separate initialization or motion prediction stages needed.</p>

<p> 
 
<img class="emoji" title=":mag:" alt=":mag:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f50d.png" height="20" width="20"> Supports dynamic agent injection for open-world, long-horizon simulation. New agents can appear (and existing ones can leave) at any timestep.</p>

<p> 
 
<img class="emoji" title=":rocket:" alt=":rocket:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f680.png" height="20" width="20"> Autonomous driving planners trained in SceneStreamer-generated scenarios show improved robustness and generalization over log-replay baselines.</p>


        </div>
        
        <div class="research-section">
            

<h2 id="abstract">Abstract</h2>

<p>Realistic and interactive traffic simulation is essential for training and evaluating autonomous driving systems. However, most existing data-driven simulation methods rely on static initialization or log-replay data, limiting their ability to model dynamic, long-horizon scenarios with evolving agent populations. We propose <strong>SceneStreamer</strong>, a scenario generation framework that outputs agent states and trajectories in an autoregressive manner. SceneStreamer represents the entire scene as a sequence of tokens—including traffic light signals, agent states, and motion vectors—and uses a transformer model to simulate traffic over time. This design enables SceneStreamer to continuously insert new agents into traffic, supporting infinite scene generation. Experiments demonstrate that SceneStreamer produces realistic, diverse, and adaptive traffic behaviors. Furthermore, reinforcement learning policies trained in SceneStreamer-generated scenarios achieve superior robustness and generalization, validating its utility as a high-fidelity simulation environment for autonomous driving.</p>


        </div>
        
        <div class="research-section">
            

<h2 id="method-overview">Method Overview</h2>

<div class="img-container" style="width: 100%; margin: 0 auto;">
    <img src="../assets/img/scenestreamer/framework.png" class="my-image" alt="Image">
</div>

<p>SceneStreamer casts scenario generation as a <strong>next-token-group prediction</strong> task. The entire driving scene is represented as a structured sequence of discrete tokens, organized into four groups per simulation step:</p>

<ul>
  <li>
<strong>Map Tokens</strong> ⟨MAP⟩: Static lane segments, crosswalks, and road features encoded via a PointNet-like encoder, serving as fixed cross-attention context throughout simulation.</li>
  <li>
<strong>Traffic Light Tokens</strong> ⟨TL⟩: Discrete signal states (green, yellow, red) for each traffic light, anchored to their associated map segments.</li>
  <li>
<strong>Agent State Tokens</strong> ⟨AS⟩: Four ordered tokens per agent—start-of-agent flag, category type, map segment index, and relative kinematic state—enabling autoregressive agent creation at any timestep.</li>
  <li>
<strong>Motion Tokens</strong> ⟨MO⟩: Discretized acceleration and yaw rate pairs, applied via a bicycle model to advance agent states forward.</li>
</ul>

<p>At each step, SceneStreamer generates ⟨TL⟩ → ⟨AS⟩ → ⟨MO⟩ conditioned on all previous tokens and the static ⟨MAP⟩ context. A grouped causal attention mechanism ensures each token group attends to its predecessors while maintaining semantic causality.</p>

<p>By selectively <strong>state-forcing</strong> different token groups at inference time, SceneStreamer can support multiple tasks with a single model: (1) Motion Prediction, (2) Scenario Generation, (3) Scenario Densification, (4) Closed-Loop Simulation.</p>


        </div>
        
        <div class="research-section">
            

<h2 id="experiments">Experiments</h2>

<h3 id="qualitative-visualization">Qualitative Visualization</h3>

<p>The following videos illustrate scenes generated by SceneStreamer in different settings, including full-scenario generation and scenario densification. Generated agents are well-aligned with map lanes, exhibit coherent motion patterns, and maintain diversity over long horizons.</p>

<p><strong>Full Scenario Generation</strong> — SceneStreamer generates the initial layout and all future motions from map context alone:</p>

<div class="video-container">
  <video loop="" autoplay="" muted="" playsinline="" src="../assets/img/scenestreamer/generated_scenario.mp4"></video>
</div>

<p> </p>

<p><strong>Scenario Densification</strong> — We state-force the states of existing agents and ask SceneStreamer to generate new agents until 128 agents are reached:</p>

<div class="video-container">
  <video loop="" autoplay="" muted="" playsinline="" src="../assets/img/scenestreamer/densified_scenario.mp4"></video>
</div>

<p> </p>

<p><strong>Densification + Extension</strong> — SceneStreamer continuously densifies and extends the scenario over a long horizon:</p>

<div class="video-container">
  <video loop="" autoplay="" muted="" playsinline="" src="../assets/img/scenestreamer/densified_and_extended_scenario.mp4"></video>
</div>

<h3 id="planner-learning-with-scenestreamer">Planner Learning with SceneStreamer</h3>

<p>To evaluate SceneStreamer’s utility for downstream autonomous driving, we train RL agents to control the self-driving car (SDC) in SceneStreamer-modified scenarios and test them on unaltered log-replay scenes. This examines whether SceneStreamer can serve as a generative simulator that improves planner robustness through diverse, reactive traffic.</p>

<table>
  <thead>
    <tr>
      <th>Training Source</th>
      <th>Reward ↑</th>
      <th>Success ↑</th>
      <th>Completion ↑</th>
      <th>Off-Road ↓</th>
      <th>Collision ↓</th>
      <th>Cost ↓</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Log-Replay</td>
      <td>32.24</td>
      <td>0.724</td>
      <td>0.673</td>
      <td>0.287</td>
      <td>0.031</td>
      <td>0.285</td>
    </tr>
    <tr>
      <td>SceneStreamer-Motion</td>
      <td>39.23</td>
      <td>0.748</td>
      <td>0.703</td>
      <td>0.299</td>
      <td><strong>0.019</strong></td>
      <td>0.264</td>
    </tr>
    <tr>
      <td>SceneStreamer-Full</td>
      <td><strong>39.07</strong></td>
      <td><strong>0.762</strong></td>
      <td><strong>0.735</strong></td>
      <td><strong>0.283</strong></td>
      <td>0.026</td>
      <td><strong>0.261</strong></td>
    </tr>
  </tbody>
</table>

<p>SceneStreamer-generated scenarios consistently improve planner performance across all metrics. Even without full scenario generation, motion-only variants outperform the log-replay baseline. The best-performing setup uses full scenario generation with reject sampling, achieving the highest route completion and lowest cost.</p>

<h3 id="waymo-sim-agents-challenge">Waymo Sim Agents Challenge</h3>

<p>SceneStreamer received the <a href="https://waymo.com/open/challenges/#past-challenges" rel="external nofollow noopener" target="_blank">Honorable Mention</a> in the Waymo Scenario Generation Challenge (under the previous name InfGen).</p>


        </div>
        
        <div class="research-section">
            

<h2 id="license-and-citation">License and Citation</h2>

<p>An earlier version of this work used the name “InfGen”. To avoid confusion with concurrent work, we refer to our method as <strong>SceneStreamer</strong>.</p>

<p>Please consider citing our paper if it helps your research.</p>

<pre><code class="language-BibTeX">@article{peng2025scenestreamer,
  title={SceneStreamer: Scenario Generation as Next Token Group Prediction},
  author={Peng, Zhenghao and Liu, Yuxin and Zhou, Bolei},
  journal={arXiv preprint arXiv:2506.23316},
  year={2025}
}
</code></pre>

        </div>
        

    </article>
</div>

<script defer src="../assets/js/copy_code.js" type="text/javascript"></script>
        </div>
      </div>
      
    </div>

    <!-- Footer -->    <footer class="sticky-bottom mt-5">
      <div class="container">
        © Copyright 2026   MetaDriverse. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script>

  <!-- Bootstrap Table -->
  <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script>

  <!-- Load Common JS -->
  <script src="/assets/js/no_defer.js"></script>
  <script defer src="/assets/js/common.js"></script>
  <script defer src="/assets/js/copy_code.js" type="text/javascript"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  <script async src="https://badge.dimensions.ai/badge.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
